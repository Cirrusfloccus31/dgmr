# Rainfall Nowcasting on France using DGMR model

This repository applies the Deep Generative Model of Rainfall (DGMR) developed by Google DeepMindto Meteo-France rainfall data. The goal of this project is to provide accurate short-term rainfall forecasts (nowcasting) on France.

## Table of Contents
- [Features](#features)
- [Installation](#installation)
- [Usage](#usage)
- [Examples](#examples)
- [Data Sources](#data-sources)
- [Model Architecture](#model-architecture)
- [Contributing](#contributing)
- [License](#license)
- [Acknowledgements](#acknowledgements)

## Features
- Short-term rainfall forecasting (up to 2 hours)
- Utilizes DGMR model for high accuracy
- Trained on Meteo-France rainfall data
- Provides visualizations for rainfall predictions
- Easy-to-use interface for generating forecasts

## Installation

### Clone the Repository

```bash
git clone https://github.com/meteofrance/dgmr
cd dgmr
```

### Install environment

With micromamba or conda:

```bash
micromamba create -f environment.yml
```

```bash
micromamba activate dgmr
```

### Set Up Environment Variables
Create a `.env` file in the root directory and add your configuration settings:
```plaintext
METEO_FRANCE_API_KEY="<your_meteo_france_api_key>"
METEO_FRANCE_DATA_PATH="<path_to_save_the_data_downloaded>"  # If empty downloaded data will be saved in ./data
```

### Download the pretrained model from Deepmind

Go to this [Google Cloud Storage](https://console.cloud.google.com/storage/browser/dm-nowcasting-example-data?pageState=(%22StorageObjectListTable%22:(%22f%22:%22%255B%255D%22))&project=friendly-retina-382415) link and download all the files and sub-folders in `dm-nowcasting-example-data/tfhub_snapshots/1536x1280` (this folder contains the pre-trained model with a size of 1536x1280).

## Usage

### Setting up a Cron Job for Automated Data Download

To automate the data download process using a cron job, follow these steps:

1. Open your terminal and type `crontab -e` to edit the cron table.

2. Add a new line at the end of the file to define the cron job. The general syntax for a cron task is:
    ```plaintext
    */5 * * * * ./dgmr/download_data.sh
    ```

To generate a rainfall nowcast, use the following command:
TODO
```bash
python  XXX
```

## Examples
Here are some example rainfall nowcasts generated by the model:

![Example Nowcast](images/example_nowcast.png)  TODO

## Data Sources
This project uses rainfall data from the following source:
- [Meteo-France](https://donneespubliques.meteofrance.fr/)

TODO : describe data

## Model Architecture
The DGMR model is a state-of-the-art generative model designed for weather nowcasting. It leverages a combination of convolutional neural networks (CNNs) and generative adversarial networks (GANs) to produce high-resolution realistic rainfall forecasts. 

For more details, please see Ravuri, S., Lenc, K., Willson, M. et al. Skilful precipitation nowcasting using deep generative models of radar. Nature 597, 672â€“677 (2021). https://doi.org/10.1038/s41586-021-03854-z. A notebook is also availbale as a supplement to the article : [notebook](https://github.com/google-deepmind/deepmind-research/tree/master/nowcasting)

## License
TODO

## Acknowledgements
- [Google DeepMind](https://doi.org/10.1038/s41586-021-03854-z) for developing the DGMR model.

## Contributors

Lab IA + EMI